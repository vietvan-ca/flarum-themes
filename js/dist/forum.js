(()=>{var t={n:e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};(()=>{"use strict";const e=flarum.core.compat["forum/app"];var r=t.n(e);const n=flarum.core.compat["common/extend"],o=flarum.core.compat["forum/components/IndexPage"];var a=t.n(o);const i=flarum.core.compat["forum/components/DiscussionListItem"];var s=t.n(i);const u=flarum.core.compat["forum/components/DiscussionList"];var c=t.n(u);const l=flarum.core.compat["forum/components/HeaderPrimary"];var d=t.n(l);function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}function f(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,v(t,e)}const p=flarum.core.compat["common/Component"];var h=t.n(p);const b=flarum.core.compat["common/components/Link"];var y=t.n(b);const _=flarum.core.compat["common/helpers/icon"];var g=t.n(_),w=function(t){function e(){return t.apply(this,arguments)||this}return f(e,t),e.prototype.view=function(){var t=this.attrs.discussion,e=t.firstPost(),n=t.tags()||[],o=t.isSticky(),a=t.isLocked();return m("div.discussion-topic",[m("div.discussion-badges",[o?m("span.Badge.Badge--sticky",[g()("fas fa-thumbtack")]):null,a?m("span.Badge.Badge--locked",[g()("fas fa-lock")]):null]),m("div.discussion-title",[m(y(),{href:r().route.discussion(t)},t.title())]),m("div.discussion-tags",[n.map((function(t){return m("span.discussion-tag",{className:t.color()?"colored":"",style:t.color()?{backgroundColor:t.color()}:{}},t.name())}))]),!1!==r().forum.attribute("custom-discussion-list.enable_excerpts")?m("div.discussion-excerpt",(null==e?void 0:e.contentPlain())||""):null])},e}(h()),k=function(t){function e(){return t.apply(this,arguments)||this}return f(e,t),e.prototype.view=function(){var t,e=null!=(t=this.attrs.discussion.replyCount())?t:0;return m("div.discussion-reply",[m("span",e)])},e}(h()),N=function(t){function e(){return t.apply(this,arguments)||this}return f(e,t),e.prototype.view=function(){var t=this.attrs.discussion.attribute("views")||0;return m("div.discussion-view",[m("span",t)])},e}(h());function x(t){var e=["color-1","color-2","color-3","color-4","color-5"];return e[t%e.length]}var P=function(t){function e(){return t.apply(this,arguments)||this}return f(e,t),e.prototype.view=function(){var t=this.attrs.discussion,e=t.lastPostedAt(),r=e?function(t){if(!t)return"-";var e="string"==typeof t?new Date(t):t;if(isNaN(e.getTime()))return"-";var r=new Date-e;if(r<0)return"-";var n=Math.floor(r/864e5),o=Math.floor(r%864e5/36e5),a=Math.floor(r%36e5/6e4);return n>=30?Math.floor(n/30)+"mo":n>0?n+"d":o>0?o+"h":a>0?a+"m":"now"}(new Date(e)):"",n=t.attribute("latestPosters")||[];return m("div.discussion-work",[m("div.time-since",r),m("div.active-users",n.slice(0,5).map((function(t,e){return function(t,e){if(!t)return null;var r,n=t.username||"",o=t.avatar_url;return o?m("span.user-avatar",{title:n},m("img.avatar-image",{src:o,alt:n})):m("span.user-avatar",{title:n},m("span.user-initial",{className:x(e)},(r=n)?r.charAt(0).toUpperCase():""))}(t,e)})))])},e}(h()),I=function(t){function e(){return t.apply(this,arguments)||this}return f(e,t),e.prototype.view=function(){var t=this.attrs.discussion;return m(y(),{className:"discussion-row",href:r().route.discussion(t)},[m(w,{discussion:t}),m(k,{discussion:t}),m(N,{discussion:t}),m(P,{discussion:t})])},e}(h()),L=function(t){function e(){return t.apply(this,arguments)||this}return f(e,t),e.prototype.view=function(){return m("li",{className:"CustomDiscussionList-header"},m("div",{className:"DiscussionListItem-info topic"},r().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.topic")),m("div",{className:"DiscussionListItem-info replies"},r().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.replies")),m("div",{className:"DiscussionListItem-info views"},r().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.views")),m("div",{className:"DiscussionListItem-info activity"},r().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.activity")))},e}(h()),S=function(t){function e(){return t.apply(this,arguments)||this}f(e,t);var r=e.prototype;return r.oninit=function(e){var r,n,o;t.prototype.oninit.call(this,e);var a=app.forum;if(this.enabled="1"===a.attribute("vietvan_ca_hero_enabled"),this.enabled){this.locale=app.translator.getLocale()||"en";var i="vietvan_ca_hero_title_"+this.locale,s="vietvan_ca_hero_description_"+this.locale;this.title=null!=(r=a.attribute(i))?r:app.translator.trans("vietvan-ca-flarum-themes.forum.hero.title"),this.description=null!=(n=a.attribute(s))?n:app.translator.trans("vietvan-ca-flarum-themes.forum.hero.description"),this.showText="1"===a.attribute("vietvan_ca_hero_show_text");var u="dark"==(2===(null==(o=app.session.user)?void 0:o.preferences().fofNightMode)?"dark":"light")?"vietvan_ca_hero_background_image_darkUrl":"vietvan_ca_hero_background_imageUrl",c=a.attribute(u);this.style=c?{backgroundImage:"url("+c+")",backgroundPosition:"center",backgroundSize:"100% auto",backgroundRepeat:"no-repeat",height:"20vh"}:void 0}},r.view=function(){if(!this.enabled)return null;var t=window.location.pathname;return"/"!==t&&""!==t?null:m("div",{className:"HeroSection",style:this.style},this.showText&&m("div",{className:"container"},m("h1",{className:"HeroSection-title"},this.title),m("p",{className:"HeroSection-subtitle"},this.description)))},e}(h());const B=flarum.core.compat["common/components/Button"];var D=t.n(B),O=function(t){function e(){return t.apply(this,arguments)||this}f(e,t);var n=e.prototype;return n.view=function(){var t=r().forum.attribute("vietvan_ca_back_button_custom_url");return t&&""!==t.trim()?m(D(),{className:"Button Button--link Header-back",icon:"fas fa-chevron-left",onclick:this.goBack.bind(this),title:r().translator.trans("vietvan-ca-flarum-themes.forum.header.back_button_tooltip")},r().translator.trans("vietvan-ca-flarum-themes.forum.header.back_button_text")||"Back"):null},n.goBack=function(){var t=r().forum.attribute("vietvan_ca_back_button_custom_url");t&&""!==t.trim()?t.startsWith("http://")||t.startsWith("https://")||t.startsWith("//")?window.location.href=t:window.location.href=r().forum.attribute("baseUrl")+t:window.history.length>1?window.history.back():window.location.href="/"},e}(h()),C=function(t){function e(){return t.apply(this,arguments)||this}f(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e)},n.view=function(){var t,e="dark"==(2===(null==(t=r().session.user)?void 0:t.preferences().fofNightMode)?"dark":"light")?"vietvan_ca_logo_darkUrl":"vietvan_ca_logoUrl",n=r().forum.attribute(e);return n?m(y(),{href:r().route("index"),className:"Header-logo CustomHeaderLogo"},m("img",{src:n,alt:"VietVan CA"})):null},e}(h());function U(){return U=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},U.apply(null,arguments)}const A=flarum.core.compat["common/components/LinkButton"];var T=t.n(A),j=function(t){function e(){return t.apply(this,arguments)||this}f(e,t);var n=e.prototype;return n.view=function(){var t,e=this,n=null==(t=r().search.params())?void 0:t.sort,o=[{key:"latest",label:r().translator.trans("core.forum.index_sort.latest_button"),sortParam:"",default:!0},{key:"top",label:r().translator.trans("core.forum.index_sort.top_button"),sortParam:"top"},{key:"newest",label:r().translator.trans("core.forum.index_sort.newest_button"),sortParam:"newest"},{key:"oldest",label:r().translator.trans("core.forum.index_sort.oldest_button"),sortParam:"oldest"}];return m("div",{className:"CustomDiscussionTabNavigation"},o.map((function(t){var o;return o=t.routeName?r().current.matches(t.routeName):t.isFilter?r().search.params.q&&r().search.params.q.includes(t.filterParam):n===t.sortParam||!n&&t.default,m(T(),{className:"SortItem Button Button--link "+(o?"active":""),onclick:function(){return e.navigateTo(t)}},t.label)})))},n.navigateTo=function(t){var e=U({},r().search.params);t.routeName?m.route.set(r().route(t.routeName)):t.isFilter?(e.q=t.filterParam,delete e.sort,m.route.set(r().route(r().current.get("routeName"),e))):(e.sort=t.sortParam,delete e.q,m.route.set(r().route(r().current.get("routeName"),e)))},e}(h());function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}r().initializers.add("vietvan-ca-themes",(function(){var t,e=function(){!function(){try{var t;if(null!=(t=r().forum)&&t.attribute&&"1"!==r().forum.attribute("vietvan_ca_show_register_button")){var e=document.querySelector(".item-signUp");null==e||e.remove()}}catch(t){console.error("Error checking register button visibility:",t)}}(),function(){try{var t=r().forum.attribute("vietvan_ca_logoUrl"),e=r().forum.attribute("vietvan_ca_logo_darkUrl");if(t||e){var n=document.querySelector(".Header-title");null==n||n.remove()}}catch(t){console.error("Error checking custom logo:",t)}}()};"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,100):document.addEventListener("DOMContentLoaded",(function(){setTimeout(e,100)})),null==(t=r().history.initialized)||t.then((function(){r().history.router.on("changed",e)})),(0,n.extend)(d().prototype,"items",(function(t){var e=r().forum.attribute("vietvan_ca_logoUrl"),n=r().forum.attribute("vietvan_ca_logo_darkUrl");(e||n)&&t.add("logo",m(C,null),90)})),(0,n.extend)(d().prototype,"items",(function(t){t.add("back-button",m(O,null),90)})),(0,n.extend)(s().prototype,"view",(function(t){t.children=[m(I,{discussion:this.attrs.discussion})]})),(0,n.extend)(c().prototype,"view",(function(t){var e=t.children;t.children=[m("ul.DiscussionList",[m(L)].concat(e))]})),(0,n.extend)(a().prototype,"view",(function(t){var r=m(S),n=t.children;t.children=[r].concat(n);var o=m(j,null),a=function(t){for(var e,r,n=t,o=function(){var t,e=r.value;if(null==(t=n)||!t.children||!Array.isArray(n.children))return{v:null};var o=n.children.find((function(t){var r;return null==t||null==(r=t.attrs)||null==(r=r.className)?void 0:r.includes(e)}));if(!o)return{v:null};n=o},a=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return M(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(["container","sideNavContainer","IndexPage-results","IndexPage-toolbar","IndexPage-toolbar-view"]);!(r=a()).done;)if(e=o())return e.v;return n}({children:n});a?a.children=[o]:console.warn("IndexPage-toolbar-view not found. CustomTabNavigation not added."),setTimeout(e,100)}))}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map