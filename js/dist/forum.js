(()=>{var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};(()=>{"use strict";const t=flarum.core.compat["forum/app"];var o=e.n(t);const n=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/components/IndexPage"];var i=e.n(r);const a=flarum.core.compat["forum/components/DiscussionListItem"];var s=e.n(a);const l=flarum.core.compat["forum/components/DiscussionList"];var c=e.n(l);const u=flarum.core.compat["forum/components/HeaderPrimary"];var d=e.n(u);const f=flarum.core.compat["forum/components/HeaderSecondary"];var h=e.n(f);const v=flarum.core.compat["common/components/TextEditor"];var p=e.n(v);function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function b(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,g(e,t)}flarum.core.compat["forum/components/Navigation"];const y=flarum.core.compat["common/Component"];var w=e.n(y);const M=flarum.core.compat["common/components/Link"];var N=e.n(M);const k=flarum.core.compat["common/helpers/icon"];var _=e.n(k),C=function(e){function t(){return e.apply(this,arguments)||this}return b(t,e),t.prototype.view=function(){var e=this.attrs.discussion,t=e.firstPost(),n=e.tags()||[],r=e.isSticky(),i=e.isLocked();return m("div.discussion-topic",[m("div.discussion-badges",[r?m("span.Badge.Badge--sticky",[_()("fas fa-thumbtack")]):null,i?m("span.Badge.Badge--locked",[_()("fas fa-lock")]):null]),m("div.discussion-title",[m(N(),{href:o().route.discussion(e)},e.title())]),m("div.discussion-tags",[n.map((function(e){return m("span.discussion-tag",{className:e.color()?"colored":"",style:e.color()?{backgroundColor:e.color()}:{}},e.name())}))]),!1!==o().forum.attribute("custom-discussion-list.enable_excerpts")?m("div.discussion-excerpt",(null==t?void 0:t.contentPlain())||""):null])},t}(w()),D=function(e){function t(){return e.apply(this,arguments)||this}return b(t,e),t.prototype.view=function(){var e,t=null!=(e=this.attrs.discussion.replyCount())?e:0;return m("div.discussion-reply",[m("span",t)])},t}(w()),x=function(e){function t(){return e.apply(this,arguments)||this}return b(t,e),t.prototype.view=function(){var e=this.attrs.discussion.attribute("views")||0;return m("div.discussion-view",[m("span",e)])},t}(w());function T(e){var t=["color-1","color-2","color-3","color-4","color-5"];return t[e%t.length]}var S=function(e){function t(){return e.apply(this,arguments)||this}return b(t,e),t.prototype.view=function(){var e=this.attrs.discussion.lastPostedAt(),t=e?function(e){if(!e)return"-";var t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))return"-";var o=new Date-t;if(o<0)return"-";var n=Math.floor(o/864e5),r=Math.floor(o%864e5/36e5),i=Math.floor(o%36e5/6e4);return n>=30?Math.floor(n/30)+"mo":n>0?n+"d":r>0?r+"h":i>0?i+"m":"now"}(new Date(e)):"";return m("div.discussion-activity",[m("span",t)])},t}(w()),E=function(e){function t(){return e.apply(this,arguments)||this}return b(t,e),t.prototype.view=function(){var e=this.attrs.discussion.attribute("latestPosters")||[];return m("div.discussion-users",[m("div.active-users",e.slice(0,5).map((function(e,t){return function(e,t){if(!e)return null;var o,n=e.username||"",r=e.avatar_url;return r?m("span.user-avatar",{title:n},m("img.avatar-image",{src:r,alt:n})):m("span.user-avatar",{title:n},m("span.user-initial",{className:T(t)},(o=n)?o.charAt(0).toUpperCase():""))}(e,t)})))])},t}(w()),L=function(e){function t(){return e.apply(this,arguments)||this}return b(t,e),t.prototype.view=function(){var e=this.attrs.discussion;return m(N(),{className:"discussion-row",href:o().route.discussion(e)},[m(C,{discussion:e}),m(E,{discussion:e}),m(D,{discussion:e}),m(x,{discussion:e}),m(S,{discussion:e})])},t}(w()),B=function(e){function t(){return e.apply(this,arguments)||this}return b(t,e),t.prototype.view=function(){return m("li",{className:"CustomDiscussionList-header"},m("div",{className:"DiscussionListItem-info topic"},o().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.topic")),m("div",{className:"DiscussionListItem-info replies"},o().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.replies")),m("div",{className:"DiscussionListItem-info views"},o().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.views")),m("div",{className:"DiscussionListItem-info activity"},o().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.activity")))},t}(w());const I=flarum.core.compat["forum/components/Search"];var P=e.n(I);const A=flarum.core.compat["forum/components/DiscussionComposer"];var q=e.n(A);const O=flarum.core.compat["forum/components/LogInModal"];var z=e.n(O);const U=flarum.core.compat["common/components/LinkButton"];var H=e.n(U);const W=flarum.core.compat["common/utils/ItemList"];var j=e.n(W);flarum.core.compat["common/components/Button"];const F=flarum.core.compat["common/components/SelectDropdown"];var R=e.n(F);const G=flarum.core.compat["common/helpers/listItems"];var V=e.n(G),$=function(e){function t(){return e.apply(this,arguments)||this}b(t,e);var n=t.prototype;return n.view=function(){var e=this;return m("div",{className:"CustomMobileDiscussionToolbar"},m("div",{className:"CustomMobileDiscussionToolbar-left"},m("span",{className:"CustomMobileDiscussionToolbar-date"},this.currentDate),R().component({buttonClassName:"Button Button--text",className:"all-discussion-select"},this.getNavigationItems().toArray())),m("button",{class:"Button Button--primary CustomMobileDiscussionToolbar-button",type:"button","aria-label":"Start Discussion",onclick:function(){return e.newDiscussionAction()}},m("i",{"aria-hidden":"true",class:"icon fas fa-edit Button-icon"}),m("span",{class:"Button-label"},o().translator.trans("core.forum.index.start_discussion_button"))))},n.getNavigationItems=function(){var e=new(j());e.add("all-discussions",H().component({href:o().route("index"),icon:"fas fa-comments"},o().translator.trans("core.forum.index.all_discussions_link")),100),e.add("tags",H().component({href:o().route("tags"),icon:"fas fa-th-large"},o().translator.trans("flarum-tags.forum.index.tags_link")),90);var t=o().store.all("tags");return t&&t.length>0&&t.filter((function(e){var t=e.parent&&e.parent(),o=e.position();return!t&&null!=o})).sort((function(e,t){return e.position()-t.position()})).forEach((function(t,n){e.add("tag-"+t.id(),H().component({href:o().route("tag",{tags:t.slug()}),icon:"fas fa-circle",style:t.color()?{color:t.color()}:{}},t.name()),80-n)})),e},n.newDiscussionAction=function(){return new Promise((function(e,t){return o().session.user?(o().composer.load(q(),{user:o().session.user}),o().composer.show(),e(o().composer)):(o().modal.show(z()),t())}))},t}(w()),Q=function(e){function t(){return e.apply(this,arguments)||this}b(t,e);var o=t.prototype;return o.oninit=function(t){var o,n,r=this;e.prototype.oninit.call(this,t);var i=app.forum;if(this.enabled="1"===i.attribute("vietvan_ca_hero_enabled"),this.enabled){this.mode="light",flarum.extensions["fof-nightmode"]&&this.setupNightModeListener(),this.setupSystemModeListener(),this.setupBodyClassObserver(),setTimeout((function(){r.mode=r.computeMode(),m.redraw()}),100),setTimeout((function(){var e=r.computeMode();e!==r.mode&&(r.mode=e,m.redraw())}),500),this.locale=app.translator.getLocale()||"en";var a="vietvan_ca_hero_title_"+this.locale,s="vietvan_ca_hero_description_"+this.locale;if(this.title=null!=(o=i.attribute(a))?o:app.translator.trans("vietvan-ca-flarum-themes.forum.hero.title"),this.description=null!=(n=i.attribute(s))?n:app.translator.trans("vietvan-ca-flarum-themes.forum.hero.description"),this.showText="1"===i.attribute("vietvan_ca_hero_show_text"),this.hasCustomColor="1"===i.attribute("vietvan_ca_hero_custom_color_enabled"),this.titleStyle={},this.descriptionStyle={},this.hasCustomColor){var l=i.attribute("vietvan_ca_hero_title_color")||"#ffffff",c=i.attribute("vietvan_ca_hero_subtitle_color")||"#ffffff";this.titleStyle={color:l},this.descriptionStyle={color:c}}}},o.computeMode=function(){var e;if(document.body.classList.contains("flarum--night"))return"dark";var t=app.session.user;if(t){var o=t.preferences().fofNightMode;return 2===o||"2"===o?"dark":1===o||"1"===o||0!==o&&"0"!==o&&null!=o||0!==o&&"0"!==o||!window.matchMedia("(prefers-color-scheme: dark)").matches?"light":"dark"}var n=null==(e=document.cookie.split("; ").find((function(e){return e.startsWith("flarum_nightmode=")})))?void 0:e.split("=")[1];return"2"===n?"dark":"1"===n?"light":"0"===n&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},o.setupNightModeListener=function(){var e=this;this.nightModeHandler=function(t){e.mode="day"===t.detail?"light":"dark",m.redraw()},document.addEventListener("fofnightmodechange",this.nightModeHandler)},o.setupSystemModeListener=function(){var e=this,t=window.matchMedia("(prefers-color-scheme: dark)");this.systemModeHandler=function(t){var o=e.computeMode();o!==e.mode&&(e.mode=o,m.redraw())},t.addEventListener("change",this.systemModeHandler)},o.setupBodyClassObserver=function(){var e=this;this.bodyObserver=new MutationObserver((function(){var t=e.computeMode();t!==e.mode&&(e.mode=t,m.redraw())})),this.bodyObserver.observe(document.body,{attributes:!0,attributeFilter:["class"]})},o.onremove=function(){this.nightModeHandler&&document.removeEventListener("fofnightmodechange",this.nightModeHandler),this.systemModeHandler&&window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",this.systemModeHandler),this.bodyObserver&&this.bodyObserver.disconnect()},o.getBackgroundStyle=function(){var e=app.forum,t="dark"===this.mode?"vietvan_ca_hero_background_image_darkUrl":"vietvan_ca_hero_background_imageUrl",o=e.attribute(t);return o?{height:"35vh",backgroundImage:"url("+o+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}:void 0},o.view=function(){if(!this.enabled)return null;var e=window.location.pathname;if("/"!==e&&""!==e)return null;var t=this.getBackgroundStyle();return m("div",{className:"HeroSection",style:t},this.showText&&m("div",{className:"container"},m("h1",{className:"HeroSection-title",style:this.titleStyle},this.title),m("p",{className:"HeroSection-subtitle",style:this.descriptionStyle},this.description)),m("div",{className:"container"},m(P(),{state:app.search})))},t}(w()),K=function(e){function t(){return e.apply(this,arguments)||this}b(t,e);var n=t.prototype;return n.oninit=function(t){var n;e.prototype.oninit.call(this,t),this.mode=2===(null==(n=o().session.user)?void 0:n.preferences().fofNightMode)?"dark":"light",flarum.extensions["fof-nightmode"]&&this.setupNightModeListener()},n.setupNightModeListener=function(){var e=this;document.addEventListener("fofnightmodechange",(function(t){e.mode="day"===t.detail?"light":"dark",m.redraw()}))},n.view=function(e){var t="dark"===this.mode?"vietvan_ca_logo_darkUrl":"vietvan_ca_logoUrl",n=o().forum.attribute(t);if(!n)return null;var r=o().forum.attribute("vietvan_ca_back_button_custom_url")||o().route("index"),i=e.attrs.imageStyle||{};return m("a",{href:r,className:"Header-logo CustomHeaderLogo"},m("img",{src:n,alt:"VietVan CA",style:i}))},t}(w()),J=function(e){function t(){return e.apply(this,arguments)||this}b(t,e);var n=t.prototype;return n.view=function(){var e,t=this,n=null==(e=o().search.params())?void 0:e.sort,r=[{key:"latest",label:o().translator.trans("core.forum.index_sort.latest_button"),sortParam:"",default:!0},{key:"top",label:o().translator.trans("core.forum.index_sort.top_button"),sortParam:"top"},{key:"newest",label:o().translator.trans("core.forum.index_sort.newest_button"),sortParam:"newest"},{key:"oldest",label:o().translator.trans("core.forum.index_sort.oldest_button"),sortParam:"oldest"}];return m("div",{className:"CustomDiscussionTabNavigation"},r.map((function(e){var r;return r=e.routeName?o().current.matches(e.routeName):e.isFilter?o().search.params.q&&o().search.params.q.includes(e.filterParam):n===e.sortParam||!n&&e.default,m(H(),{className:"SortItem Button Button--link "+(r?"active":""),onclick:function(){return t.navigateTo(e)}},e.label)})))},n.navigateTo=function(e){var t=m.route.get().split("?")[0];e.default||(t+="?sort="+e.sortParam),m.route.set(t)},t}(w());function X(e,t){var n=o().translator.trans("vietvan-ca-flarum-themes.forum.mobile_drawer."+e);return n&&n!=="vietvan-ca-flarum-themes.forum.mobile_drawer."+e?n:t}flarum.core.compat["common/components/Separator"];var Y=function(e){function t(){return e.apply(this,arguments)||this}b(t,e);var n=t.prototype;return n.oninit=function(t){e.prototype.oninit.call(this,t)},n.view=function(){return m("div",{className:"CustomMobileDrawer"},m("div",{className:"CustomMobileDrawer-logo"},m(K,{imageStyle:{height:"40px"}})),m("nav",{className:"CustomMobileDrawer-nav"},m("ul",{className:"CustomMobileDrawer-menu"},V()(this.menuItems().toArray()))),m("div",{className:"CustomMobileDrawer-separator"}),m("div",{className:"CustomMobileDrawer-auth"},o().session.user?this.loggedInSection():this.guestSection()))},n.menuItems=function(){var e=new(j()),t=o().forum.attribute("vietvan_ca_back_button_custom_url")||o().forum.attribute("baseUrl").replace("/forum","");e.add("home",m("li",{className:"CustomMobileDrawer-menuItem"},m("a",{href:t,className:"CustomMobileDrawer-link"},X("home","Trang Chủ"))),100),e.add("forum",m("li",{className:"CustomMobileDrawer-menuItem active"},m("a",{href:o().forum.attribute("baseUrl"),className:"CustomMobileDrawer-link"},X("forum","Diễn Đàn"))),90);var n=this.findTagBySlug("luu-y")||this.findTagBySlug("guidelines");return n&&e.add("guidelines",m("li",{className:"CustomMobileDrawer-menuItem"},m("a",{href:o().route("tag",{tags:n.slug()}),className:"CustomMobileDrawer-link"},X("guidelines","Lưu ý"))),80),e.add("language",m("li",{className:"CustomMobileDrawer-menuItem CustomMobileDrawer-menuItem--dropdown"},this.languageDropdown()),70),e.add("theme",m("li",{className:"CustomMobileDrawer-menuItem CustomMobileDrawer-menuItem--dropdown"},this.themeToggle()),60),e},n.findTagBySlug=function(e){return o().store&&o().store.all?o().store.all("tags").find((function(t){return t.slug()===e})):null},n.languageDropdown=function(){var e=this,t=o().data.locales||{},n=o().data.locale||"en";return Object.keys(t).length<=1?m("div",{className:"CustomMobileDrawer-languageDisplay"},m("span",{className:"CustomMobileDrawer-link"},this.getLocaleName(n),m("i",{className:"fas fa-globe CustomMobileDrawer-icon"}))):m("div",{className:"CustomMobileDrawer-dropdown"},m("button",{className:"CustomMobileDrawer-link CustomMobileDrawer-dropdownTrigger",onclick:function(t){return e.toggleDropdown(t,"language")}},this.getLocaleName(n),m("i",{className:"fas fa-chevron-down CustomMobileDrawer-chevron"})),m("ul",{className:"CustomMobileDrawer-dropdownMenu",id:"language-dropdown"},Object.keys(t).map((function(o){return m("li",{key:o},m("a",{href:"javascript:void(0)",onclick:function(){return e.changeLocale(o)},className:n===o?"active":""},t[o]))}))))},n.getLocaleName=function(e){var t;return{en:"English",vi:"Tiếng Việt"}[e]||(null==(t=o().data.locales)?void 0:t[e])||e},n.changeLocale=function(e){o().session.user?o().session.user.savePreferences({locale:e}).then((function(){window.location.reload()})):(document.cookie="locale="+e+";path=/;max-age=31536000",window.location.reload())},n.themeToggle=function(){var e=this;return o().forum.attribute("darkMode")||localStorage.getItem("fofNightMode"),m("button",{className:"CustomMobileDrawer-link",onclick:function(){return e.toggleTheme()}},m("i",{className:"fas fa-cog CustomMobileDrawer-icon--left"}),X("appearance","Giao Diện"))},n.toggleTheme=function(){var e=document.querySelector(".item-nightMode button, .NightMode-toggle");if(e)e.click();else{document.body.classList.toggle("dark");var t=document.body.classList.contains("dark");localStorage.setItem("fofNightMode",t?"dark":"light")}},n.toggleDropdown=function(e,t){e.preventDefault(),e.stopPropagation();var o=document.getElementById(t+"-dropdown");o&&o.classList.toggle("open")},n.guestSection=function(){var e=this,t=o().forum.attribute("vietvan_ca_back_button_custom_url")||"",n=t?t.replace("/forum","").replace(/\/$/,""):"";return m("div",{className:"CustomMobileDrawer-guest"},m("a",{href:n+"/auth/register",className:"Button Button--primary CustomMobileDrawer-registerBtn"},X("register","Đăng ký")),m("button",{className:"Button Button--secondary CustomMobileDrawer-loginBtn",onclick:function(){return e.showLoginModal()}},X("login","Đăng nhập")),m("div",{className:"CustomMobileDrawer-socialSeparator"},m("span",null,X("or","Hoặc:"))),m("div",{className:"CustomMobileDrawer-socialButtons"},m("button",{className:"Button CustomMobileDrawer-socialBtn CustomMobileDrawer-socialBtn--facebook",onclick:function(){return e.socialLogin("facebook")}},m("i",{className:"fab fa-facebook CustomMobileDrawer-socialIcon"}),X("login_facebook","Đăng nhập bằng Facebook")),m("button",{className:"Button CustomMobileDrawer-socialBtn CustomMobileDrawer-socialBtn--google",onclick:function(){return e.socialLogin("google")}},m("img",{src:"https://www.google.com/favicon.ico",alt:"Google",className:"CustomMobileDrawer-socialIcon CustomMobileDrawer-socialIcon--img"}),X("login_google","Đăng nhập bằng Google"))))},n.socialLogin=function(e){var t=o().forum.attribute("vietvan_ca_back_button_custom_url")||"",n=t?t.replace("/forum","").replace(/\/$/,""):"",r=encodeURIComponent(window.location.href);window.location.href=n+"/auth/"+e+"?redirect="+r},n.loggedInSection=function(){var e=this,t=o().session.user;return m("div",{className:"CustomMobileDrawer-user"},m("div",{className:"CustomMobileDrawer-userIdentity"},m("div",{className:"CustomMobileDrawer-avatar CustomMobileDrawer-avatar--default"},t.avatarUrl()?m("img",{src:t.avatarUrl(),alt:t.displayName()}):m("i",{className:"fas fa-user"})),m("div",{className:"CustomMobileDrawer-userName"},m("span",{className:"CustomMobileDrawer-displayName"},t.displayName()),m("a",{href:o().route("settings"),className:"CustomMobileDrawer-accountSettingsBtn"},X("account_settings","Cài đặt tài khoản")))),m("ul",{className:"CustomMobileDrawer-userMenu"},m("li",null,m("a",{href:o().route.user(t),className:"CustomMobileDrawer-link"},m("i",{className:"fas fa-user CustomMobileDrawer-icon--left"}),X("profile","Trang cá nhân"))),m("li",null,m("a",{href:o().route("settings"),className:"CustomMobileDrawer-link"},m("i",{className:"fas fa-cog CustomMobileDrawer-icon--left"}),X("settings","Cài đặt"))),m("li",null,m("button",{className:"CustomMobileDrawer-link CustomMobileDrawer-logout",onclick:function(){return e.logout()}},m("i",{className:"fas fa-sign-out-alt CustomMobileDrawer-icon--left"}),X("logout","Đăng xuất")))))},n.showLoginModal=function(){var e=document.querySelector("#drawer, .App-drawer");e&&(e.classList.remove("in"),document.body.classList.remove("drawerOpen")),o().modal.show(z())},n.logout=function(){var e=X("logout_confirm","Bạn có chắc chắn muốn đăng xuất?");confirm(e)&&o().session.logout()},t}(w()),Z=function(){function e(){this.observers=new Map,this.isProcessing=!1}var t=e.prototype;return t.cleanup=function(){if(!this.isProcessing){this.isProcessing=!0;try{this.hideByAttributes(),this.hideByPosition(),this.hideUploadButtons(),this.hideRichTextToggle()}catch(e){console.warn("PageManager: Error during cleanup:",e)}finally{this.isProcessing=!1}}},t.hideByAttributes=function(){var e=this,t=document.querySelector(".TextEditor-toolbar");t&&['button[data-hotkey="Ctrl+K"]','button[title*="Link"]','div[data-tooltip*="Link"]','button[data-hotkey="Ctrl+>"]','button[title*="Quote"]','div[data-tooltip*="Quote"]','button[data-hotkey="Ctrl+`"]','button[title*="Code"]','div[data-tooltip*="Code"]'].forEach((function(o){t.querySelectorAll(o).forEach((function(t){return e.hideElement(t)}))}))},t.hideByPosition=function(){var e=this;[".TextEditor-toolbar > div > button:nth-child(4)",".TextEditor-toolbar > div > button:nth-child(5)",".TextEditor-toolbar > div > div:nth-child(1)",".TextEditor-toolbar > div > div:nth-child(6)",".TextEditor-toolbar > div > div:nth-child(7)",".TextEditor-toolbar > div > div:nth-child(10)"].forEach((function(t){document.querySelectorAll(t).forEach((function(t){return e.hideElement(t)}))}))},t.hideUploadButtons=function(){var e=this;[".item-fof-upload","li.item-fof-upload",'.Button--icon[title*="upload" i]','.Button--icon[title*="file" i]'].forEach((function(t){document.querySelectorAll(t).forEach((function(t){return e.hideElement(t)}))}))},t.hideRichTextToggle=function(){var e=this;document.querySelectorAll(".item-rich-text").forEach((function(t){return e.hideElement(t)}))},t.hideElement=function(e){e&&!e.dataset.vietvanHidden&&(e.dataset.vietvanHidden="true",e.style.setProperty("display","none","important"),e.style.setProperty("visibility","hidden","important"),e.style.setProperty("opacity","0","important"),e.style.setProperty("pointer-events","none","important"),e.style.setProperty("height","0","important"),e.style.setProperty("width","0","important"),e.style.setProperty("overflow","hidden","important"),e.style.setProperty("margin","0","important"),e.style.setProperty("padding","0","important"),e.classList.add("vietvan-hidden"),e.setAttribute("aria-hidden","true"),e.setAttribute("hidden",""))},t.startObserving=function(){var e=this,t=function(){var t=document.querySelector("#composer");if(t&&!e.observers.has("composer")){var o=new MutationObserver((function(t){var o=!1;t.forEach((function(e){"childList"===e.type?e.addedNodes.forEach((function(e){e.nodeType===Node.ELEMENT_NODE&&(null!=e.matches&&e.matches(".TextEditor-toolbar")||null!=e.querySelector&&e.querySelector(".TextEditor-toolbar"))&&(o=!0)})):"attributes"===e.type&&null!=e.target.matches&&e.target.matches(".TextEditor-toolbar *")&&(o=!0)})),o&&setTimeout((function(){return e.cleanup()}),50)}));o.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class","data-hotkey","title"]}),e.observers.set("composer",o)}};t(),function(){if(!e.observers.has("body")){var o=new MutationObserver((function(o){var n=!1;o.forEach((function(e){"childList"===e.type&&e.addedNodes.forEach((function(e){e.nodeType===Node.ELEMENT_NODE&&(null!=e.matches&&e.matches("#composer")||null!=e.querySelector&&e.querySelector("#composer"))&&(setTimeout(t,50),n=!0)}))})),n&&setTimeout((function(){return e.cleanup()}),100)}));o.observe(document.body,{childList:!0,subtree:!0}),e.observers.set("body",o)}}()},t.stopObserving=function(){this.observers.forEach((function(e){return e.disconnect()})),this.observers.clear()},t.initialize=function(){var e=this;this.cleanup(),this.startObserving(),setInterval((function(){document.querySelector(".TextEditor-toolbar")&&e.cleanup()}),3e4)},e}();function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}o().initializers.add("vietvan-ca-themes",(function(){var e=new Z;e.initialize(),console.log("CustomMobileDrawer component:",Y),console.log("Mithril m function:",m);var t,r,a=function(){if(console.log("createMobileDrawer called - window width:",window.innerWidth),window.innerWidth>768)console.log("Not mobile, exiting createMobileDrawer");else{var e=document.querySelector(".vietvan-mobile-drawer");if(e)return console.log("Mobile drawer already exists, skipping creation"),console.log("Existing drawer element:",e),console.log("Existing drawer styles:",e.style.cssText),void console.log("Existing drawer position:",e.getBoundingClientRect());console.log("Creating mobile-only custom drawer");var t=document.createElement("div");t.className="vietvan-mobile-drawer",t.id="vietvan-mobile-drawer",console.log("Mobile drawer element created:",t),t.style.cssText="\n      position: fixed;\n      top: 0;\n      right: -100%;\n      width: 280px;\n      height: 100vh;\n      background: white;\n      z-index: 1050;\n      transition: right 0.3s ease;\n      box-shadow: -2px 0 10px rgba(0,0,0,0.1);\n      overflow-y: auto;\n    ",console.log("Attempting to mount CustomMobileDrawer component...");try{m.mount(t,Y),console.log("CustomMobileDrawer mounted successfully")}catch(e){return void console.error("Error mounting CustomMobileDrawer:",e)}document.body.appendChild(t),console.log("Mobile drawer added to body");var o=function(){for(var e=null,o=0,n=[".App-drawerToggle","[data-drawer-toggle]",'.Button--icon[title*="menu"]','.Button--icon[aria-label*="menu"]',".Header-controls .Button--icon",".App-primaryControl .Button--icon",".Button.Button--icon.Button--link"];o<n.length;o++){var r=n[o];if(e=document.querySelector(r)){console.log("Found drawer toggle with selector:",r,e);break}}var i=document.querySelectorAll('.Button--icon, [class*="toggle"], [class*="drawer"]');if(console.log("All potential toggle buttons:",i),e&&!e.hasAttribute("data-vietvan-mobile-handler")){e.setAttribute("data-vietvan-mobile-handler","true"),console.log("Added mobile handler to drawer toggle");var a=e.cloneNode(!0);e.parentNode.replaceChild(a,e),(e=a).addEventListener("click",(function(e){if(console.log("Drawer toggle clicked, window width:",window.innerWidth),window.innerWidth<=768){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),console.log("Mobile click detected, preventing default and toggling custom drawer");var o=t.style.right,n="0px"===o,r=n?"-100%":"0px";console.log("Current right:",o,"Is open:",n,"New right:",r),t.style.right=r,document.body.classList.toggle("vietvan-drawer-open",!n);var i=document.querySelector("#drawer, .App-drawer");return i&&!n&&(i.style.display="none",setTimeout((function(){"none"===i.style.display&&(i.style.display="")}),300)),console.log("Mobile drawer toggled:",!n),console.log("Drawer element after toggle:",t),!1}}),!0),["touchstart","mousedown"].forEach((function(t){e.addEventListener(t,(function(e){window.innerWidth<=768&&console.log(t+" event intercepted on mobile")}),!0)}))}else e?console.log("Drawer toggle already has handler"):console.log("No drawer toggle button found with any selector")};o(),setTimeout(o,500),setTimeout(o,1e3),document.addEventListener("click",(function(e){window.innerWidth<=768&&"0px"===t.style.right&&!t.contains(e.target)&&!e.target.closest(".App-drawerToggle")&&(t.style.right="-100%",document.body.classList.remove("vietvan-drawer-open"))})),t.setAttribute("data-outside-handler","true"),console.log("Mobile drawer created successfully");var n=function(){var e=document.querySelector("#drawer, .App-drawer");e&&(e.style.display="none",e.style.visibility="hidden",e.style.opacity="0",e.style.pointerEvents="none",console.log("Hidden default drawer:",e))};n(),setTimeout(n,100),setTimeout(n,500)}},l=function(){var e;console.log("handleResponsiveDrawer called - window width:",window.innerWidth),window.innerWidth<=768?(console.log("Mobile detected, creating drawer..."),a()):(console.log("Desktop detected, removing drawer..."),(e=document.querySelector(".vietvan-mobile-drawer"))&&(console.log("Removing mobile drawer for desktop"),m.mount(e,null),e.remove(),document.body.classList.remove("vietvan-drawer-open"),document.querySelectorAll("[data-vietvan-mobile-handler]").forEach((function(e){e.removeAttribute("data-vietvan-mobile-handler")}))))};console.log("Initializing mobile drawer system..."),document.addEventListener("DOMContentLoaded",(function(){console.log("DOM loaded, checking mobile drawer..."),setTimeout(l,200)})),setTimeout((function(){console.log("500ms timeout - checking mobile drawer..."),l()}),500),setTimeout((function(){console.log("1000ms timeout - checking mobile drawer..."),l()}),1e3),setTimeout((function(){console.log("2000ms timeout - checking mobile drawer..."),l()}),2e3),setTimeout((function(){if(console.log("Manual test: forcing mobile drawer creation..."),window.innerWidth<=768){var e=document.querySelector(".vietvan-mobile-drawer");if(e){console.log("Mobile drawer exists:",e),console.log("Testing drawer visibility..."),e.style.right="0px",document.body.classList.add("vietvan-drawer-open"),console.log("Forced drawer to show");var t=document.createElement("button");t.textContent="Toggle Mobile Drawer (TEST)",t.style.cssText="position: fixed; top: 10px; left: 10px; z-index: 9999; background: red; color: white; padding: 10px;",t.onclick=function(){var t="0px"===e.style.right;e.style.right=t?"-100%":"0px",document.body.classList.toggle("vietvan-drawer-open",!t),console.log("Test button toggled drawer:",!t)},document.body.appendChild(t),console.log("Added test button")}else console.log("No mobile drawer found, forcing creation..."),a()}}),3e3),window.addEventListener("resize",(function(){clearTimeout(t),t=setTimeout((function(){console.log("Window resized, handling mobile drawer"),l()}),250)})),o().history&&(null==(r=o().history.initialized)||r.then((function(){o().history.router.on("changed",(function(){setTimeout(l,200)}))})));var u,f=function(){document.querySelectorAll(".item-hide button .fa-trash-alt").forEach((function(e){e.classList.contains("fa-trash-alt")&&(e.classList.remove("fa-trash-alt"),e.classList.add("fa-eye"))})),document.querySelectorAll(".item-hidden .fas.fa-trash, .Badge--hidden .fas.fa-trash").forEach((function(e){e.classList.contains("fa-trash")&&(e.classList.remove("fa-trash"),e.classList.add("fa-eye"))}))};setTimeout(f,500),null!=(u=o().history)&&u.initialized&&o().history.initialized.then((function(){o().history.router.on("changed",(function(){setTimeout(f,500)}))})),setInterval(f,2e3),setTimeout((function(){o().session.user&&(null==o().session.user.preferences().fofNightMode&&o().session.user.savePreferences({fofNightMode:!1}).catch((function(){})));var e=document.body,t=document.documentElement;"true"===localStorage.getItem("fof-nightmode")||"true"===localStorage.getItem("darkMode")||[e,t].forEach((function(e){e&&["dark","dark-mode","fof-nightmode"].forEach((function(t){e.classList.remove(t)}))}))}),100);var v,g=function(){document.querySelectorAll(".discussion-tag.colored").forEach((function(e){return b(e,"backgroundColor")})),document.querySelectorAll('.Button--tagColored, .Button--primary[style*="--color"]').forEach((function(e){var t=e.style.getPropertyValue("--color");t&&b(e,"customColor",t)}))},b=function(e,t,o){var n,r,i,a;if(void 0===o&&(o=null),(n="customColor"===t&&o?o:window.getComputedStyle(e).backgroundColor).startsWith("#")){var s=n.replace("#","");if(3===s.length)r=parseInt(s.substr(0,1)+s.substr(0,1),16),i=parseInt(s.substr(1,1)+s.substr(1,1),16),a=parseInt(s.substr(2,1)+s.substr(2,1),16);else{if(6!==s.length)return;r=parseInt(s.substr(0,2),16),i=parseInt(s.substr(2,2),16),a=parseInt(s.substr(4,2),16)}}else{var l=n.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(!l)return;var c=l.map(Number);r=c[1],i=c[2],a=c[3]}var u=(.299*r+.587*i+.114*a)/255,m=Math.sqrt(.241*r*r+.691*i*i+.068*a*a)/255,d=(r+i+a)/765,f=Math.max(r,i,a)/255,h=Math.min(r,i,a)/255,v=0===f?0:(f-h)/f,p=(Math.max(u,.05)+.05)/.1,g=1.05/(Math.max(u,.05)+.05),b=v>.8&&u>.7?.6:v>.4?.75:.65,y=u>b&&m>b-.1&&d>b-.15&&p>g;e.style.setProperty("color",y?"#000000":"#ffffff","important");var w=y?"0 0 1px rgba(255, 255, 255, 0.6)":"0 0 1px rgba(0, 0, 0, 0.8)";e.style.setProperty("text-shadow",w,"important"),"customColor"===t&&o&&(e.style.setProperty("background-color",o,"important"),e.classList.remove("text-contrast--dark","text-contrast--light"))};setTimeout(g,200),null!=(v=o().history)&&v.initialized&&o().history.initialized.then((function(){o().history.router.on("changed",(function(){setTimeout(g,200)}))})),setInterval(g,3e3),new MutationObserver((function(){setTimeout(g,100)})).observe(document.body,{childList:!0,subtree:!0}),(0,n.extend)(p().prototype,"oncreate",(function(){setTimeout((function(){e.cleanup()}),50)})),(0,n.extend)(p().prototype,"onupdate",(function(){setTimeout((function(){return e.cleanup()}),25)}));var y,w=function(){!function(){try{var e;if(null!=(e=o().forum)&&e.attribute&&"1"!==o().forum.attribute("vietvan_ca_show_register_button")){var t=document.querySelector(".item-signUp");null==t||t.remove()}}catch(e){console.error("Error checking register button visibility:",e)}}(),function(){try{var e=o().forum.attribute("vietvan_ca_logoUrl"),t=o().forum.attribute("vietvan_ca_logo_darkUrl");if(e||t){var n=document.querySelector(".Header-title");null==n||n.remove()}}catch(e){console.error("Error checking custom logo:",e)}}()};"complete"===document.readyState||"interactive"===document.readyState?setTimeout(w,100):document.addEventListener("DOMContentLoaded",(function(){setTimeout(w,100)})),null==(y=o().history.initialized)||y.then((function(){o().history.router.on("changed",w)})),(0,n.extend)(d().prototype,"items",(function(e){var t=o().forum.attribute("vietvan_ca_logoUrl"),n=o().forum.attribute("vietvan_ca_logo_darkUrl");(t||n)&&e.add("logo",m(K,null),90)})),(0,n.extend)(h().prototype,"items",(function(e){e.has("search")&&e.remove("search")})),(0,n.extend)(s().prototype,"view",(function(e){e.children=[m(L,{discussion:this.attrs.discussion})]})),(0,n.extend)(c().prototype,"view",(function(e){var t=e.children;e.children=[m("ul.DiscussionList",[m(B)].concat(t))]})),(0,n.extend)(i().prototype,"view",(function(e){var t=m(Q),o=e.children;e.children=[t].concat(o);var n=m($,null),r=m(J,null),i=function(e){for(var t,o,n=e,r=function(){var e,t=o.value;if(null==(e=n)||!e.children||!Array.isArray(n.children))return{v:null};var r=n.children.find((function(e){var o;return null==e||null==(o=e.attrs)||null==(o=o.className)?void 0:o.includes(t)}));if(!r)return{v:null};n=r},i=function(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(o)return(o=o.call(e)).next.bind(o);if(Array.isArray(e)||(o=function(e,t){if(e){if("string"==typeof e)return ee(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?ee(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(["container","sideNavContainer","IndexPage-results","IndexPage-toolbar","IndexPage-toolbar-view"]);!(o=i()).done;)if(t=r())return t.v;return n}({children:o});i?i.children=[n,r]:console.warn("IndexPage-toolbar-view not found. CustomTabNavigation not added."),setTimeout(w,100)})),(0,n.extend)(i().prototype,"oncreate",(function(){var e=o().forum.attribute("vietvan_ca_logoUrl"),t=o().forum.attribute("vietvan_ca_logo_darkUrl");(e||t)&&this.addMobileLogo()})),(0,n.extend)(i().prototype,"onupdate",(function(){var e=o().forum.attribute("vietvan_ca_logoUrl"),t=o().forum.attribute("vietvan_ca_logo_darkUrl");(e||t)&&this.addMobileLogo()})),i().prototype.addMobileLogo=function(){var e=document.getElementById("app-navigation");if(e&&!e.querySelector(".Navigation-logo")){var t=document.createElement("div");t.className="Navigation-logo Mobile-only",m.mount(t,{view:function(){return m(K,{imageStyle:{height:"30px"}})}});var o=e.querySelector(".App-backControl");o?e.insertBefore(t,o):e.insertBefore(t,e.firstChild)}},(0,n.extend)(i().prototype,"onremove",(function(){var e=document.getElementById("app-navigation"),t=null==e?void 0:e.querySelector(".Navigation-logo");t&&(m.mount(t,null),t.remove())})),function(e){var t=document.getElementById("font-zoom-style");t&&t.remove();var o=document.createElement("style");o.id="font-zoom-style",o.textContent="\n    .App {\n      font-size: 1.05rem !important;\n    }\n    \n    /* Ensure consistent scaling across all text elements */\n    .Post-body,\n    .PostPreview-body,\n    .UserCard-info,\n    .NotificationGrid-content,\n    .Dropdown-menu,\n    .Modal-body,\n    .Form-group label,\n    .Form-group input,\n    .Form-group textarea,\n    .TagLabel,\n    .Badge {\n      font-size: 1.05em !important;\n    }\n    \n    /* Scale headings proportionally */\n    h1 { font-size: 2.1rem !important; }\n    h2 { font-size: "+1.5*e+"rem !important; }\n    h3 { font-size: 1.3125rem !important; }\n    h4 { font-size: "+1.125*e+"rem !important; }\n    h5 { font-size: 1.05rem !important; }\n    h6 { font-size: "+.875*e+"rem !important; }\n    \n    /* Scale code blocks */\n    code,\n    pre {\n      font-size: "+.875*e+"em !important;\n    }\n  ",document.head.appendChild(o),localStorage.setItem("flarum-font-zoom-scale",e.toString())}(1.05)}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map