(()=>{var t={24:t=>{"use strict";if(void 0===flarum.core.compat["forum/components/DiscussionPage"]){var e=new Error("Cannot find module 'flarum.core.compat['forum/components/DiscussionPage']'");throw e.code="MODULE_NOT_FOUND",e}t.exports=flarum.core.compat["forum/components/DiscussionPage"]},947:t=>{"use strict";if(void 0===flarum.core.compat["forum/components/UserPage"]){var e=new Error("Cannot find module 'flarum.core.compat['forum/components/UserPage']'");throw e.code="MODULE_NOT_FOUND",e}t.exports=flarum.core.compat["forum/components/UserPage"]}},e={};function o(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,o),r.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=flarum.core.compat["forum/app"];var e=o.n(t);const n=flarum.core.compat["common/extend"],i=flarum.core.compat["forum/components/IndexPage"];var r=o.n(i);const a=flarum.core.compat["forum/components/DiscussionListItem"];var s=o.n(a);const u=flarum.core.compat["forum/components/DiscussionList"];var c=o.n(u);const l=flarum.core.compat["forum/components/HeaderPrimary"];var d=o.n(l);const f=flarum.core.compat["forum/components/HeaderSecondary"];var h=o.n(f);const p=flarum.core.compat["common/components/TextEditor"];var v=o.n(p);function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}function y(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,g(t,e)}flarum.core.compat["forum/utils/DiscussionControls"],flarum.core.compat["common/components/Button"];const b=flarum.core.compat["common/Component"];var w=o.n(b);const L=flarum.core.compat["common/components/Link"];var C=o.n(L);const M=flarum.core.compat["common/helpers/icon"];var _=o.n(M),k=function(t){function o(){return t.apply(this,arguments)||this}return y(o,t),o.prototype.view=function(){var t=this.attrs.discussion,o=t.firstPost(),n=t.tags()||[],i=t.isSticky(),r=t.isLocked();return m("div.discussion-topic",[m("div.discussion-badges",[i?m("span.Badge.Badge--sticky",[_()("fas fa-thumbtack")]):null,r?m("span.Badge.Badge--locked",[_()("fas fa-lock")]):null]),m("div.discussion-title",[m(C(),{href:e().route.discussion(t)},t.title())]),m("div.discussion-tags",[n.map((function(t){return m("span.discussion-tag",{className:t.color()?"colored":"",style:t.color()?{backgroundColor:t.color()}:{}},t.name())}))]),!1!==e().forum.attribute("custom-discussion-list.enable_excerpts")?m("div.discussion-excerpt",(null==o?void 0:o.contentPlain())||""):null])},o}(w()),N=function(t){function e(){return t.apply(this,arguments)||this}return y(e,t),e.prototype.view=function(){var t,e=null!=(t=this.attrs.discussion.replyCount())?t:0;return m("div.discussion-reply",[m("span",e)])},e}(w()),D=function(t){function e(){return t.apply(this,arguments)||this}return y(e,t),e.prototype.view=function(){var t=this.attrs.discussion.attribute("views")||0;return m("div.discussion-view",[m("span",t)])},e}(w());function S(t){var e=["color-1","color-2","color-3","color-4","color-5"];return e[t%e.length]}var I=function(t){function e(){return t.apply(this,arguments)||this}return y(e,t),e.prototype.view=function(){var t=this.attrs.discussion.lastPostedAt(),e=t?function(t){if(!t)return"-";var e="string"==typeof t?new Date(t):t;if(isNaN(e.getTime()))return"-";var o=new Date-e;if(o<0)return"-";var n=Math.floor(o/864e5),i=Math.floor(o%864e5/36e5),r=Math.floor(o%36e5/6e4);return n>=30?Math.floor(n/30)+"mo":n>0?n+"d":i>0?i+"h":r>0?r+"m":"now"}(new Date(t)):"";return m("div.discussion-activity",[m("span",e)])},e}(w()),E=function(t){function e(){return t.apply(this,arguments)||this}return y(e,t),e.prototype.view=function(){var t=this.attrs.discussion.attribute("latestPosters")||[];return m("div.discussion-users",[m("div.active-users",t.slice(0,5).map((function(t,e){return function(t,e){if(!t)return null;var o,n=t.username||"",i=t.avatar_url;return i?m("span.user-avatar",{title:n},m("img.avatar-image",{src:i,alt:n})):m("span.user-avatar",{title:n},m("span.user-initial",{className:S(e)},(o=n)?o.charAt(0).toUpperCase():""))}(t,e)})))])},e}(w()),T=function(t){function o(){return t.apply(this,arguments)||this}return y(o,t),o.prototype.view=function(){var t=this.attrs.discussion;return m(C(),{className:"discussion-row",href:e().route.discussion(t)},[m(k,{discussion:t}),m(E,{discussion:t}),m(N,{discussion:t}),m(D,{discussion:t}),m(I,{discussion:t})])},o}(w()),P=function(t){function o(){return t.apply(this,arguments)||this}return y(o,t),o.prototype.view=function(){return m("li",{className:"CustomDiscussionList-header"},m("div",{className:"DiscussionListItem-info topic"},e().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.topic")),m("div",{className:"DiscussionListItem-info replies"},e().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.replies")),m("div",{className:"DiscussionListItem-info views"},e().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.views")),m("div",{className:"DiscussionListItem-info activity"},e().translator.trans("vietvan-ca-flarum-themes.forum.custom-discussion-header.activity")))},o}(w());const x=flarum.core.compat["forum/components/Search"];var B=o.n(x);const A=flarum.core.compat["forum/components/DiscussionComposer"];var O=o.n(A);const q=flarum.core.compat["forum/components/LogInModal"];var U=o.n(q);const H=flarum.core.compat["common/components/LinkButton"];var F=o.n(H);const z=flarum.core.compat["common/utils/ItemList"];var V=o.n(z);const j=flarum.core.compat["common/components/SelectDropdown"];var Q=o.n(j);const G=flarum.core.compat["common/helpers/listItems"];var R=o.n(G),$=function(t){function o(){return t.apply(this,arguments)||this}y(o,t);var n=o.prototype;return n.view=function(){var t=this;return m("div",{className:"CustomMobileDiscussionToolbar"},m("div",{className:"CustomMobileDiscussionToolbar-left"},m("span",{className:"CustomMobileDiscussionToolbar-date"},this.currentDate),Q().component({buttonClassName:"Button Button--text",className:"all-discussion-select"},this.getNavigationItems().toArray())),m("button",{class:"Button Button--primary CustomMobileDiscussionToolbar-button",type:"button","aria-label":"Start Discussion",onclick:function(){return t.newDiscussionAction()}},m("i",{"aria-hidden":"true",class:"icon fas fa-edit Button-icon"}),m("span",{class:"Button-label"},e().translator.trans("core.forum.index.start_discussion_button"))))},n.getNavigationItems=function(){var t=new(V());t.add("all-discussions",F().component({href:e().route("index"),icon:"fas fa-comments"},e().translator.trans("core.forum.index.all_discussions_link")),100),t.add("tags",F().component({href:e().route("tags"),icon:"fas fa-th-large"},e().translator.trans("flarum-tags.forum.index.tags_link")),90);var o=e().store.all("tags");return o&&o.length>0&&o.filter((function(t){var e=t.parent&&t.parent(),o=t.position();return!e&&null!=o})).sort((function(t,e){return t.position()-e.position()})).forEach((function(o,n){t.add("tag-"+o.id(),F().component({href:e().route("tag",{tags:o.slug()}),icon:"fas fa-circle",style:o.color()?{color:o.color()}:{}},o.name()),80-n)})),t},n.newDiscussionAction=function(){return new Promise((function(t,o){return e().session.user?(e().composer.load(O(),{user:e().session.user}),e().composer.show(),t(e().composer)):(e().modal.show(U()),o())}))},o}(w()),W=function(t){function e(){return t.apply(this,arguments)||this}y(e,t);var o=e.prototype;return o.oninit=function(e){var o,n,i=this;t.prototype.oninit.call(this,e);var r=app.forum;if(this.enabled="1"===r.attribute("vietvan_ca_hero_enabled"),this.enabled){this.mode="light",flarum.extensions["fof-nightmode"]&&this.setupNightModeListener(),this.setupSystemModeListener(),this.setupBodyClassObserver(),setTimeout((function(){i.mode=i.computeMode(),m.redraw()}),100),setTimeout((function(){var t=i.computeMode();t!==i.mode&&(i.mode=t,m.redraw())}),500),this.locale=app.translator.getLocale()||"en";var a="vietvan_ca_hero_title_"+this.locale,s="vietvan_ca_hero_description_"+this.locale;if(this.title=null!=(o=r.attribute(a))?o:app.translator.trans("vietvan-ca-flarum-themes.forum.hero.title"),this.description=null!=(n=r.attribute(s))?n:app.translator.trans("vietvan-ca-flarum-themes.forum.hero.description"),this.showText="1"===r.attribute("vietvan_ca_hero_show_text"),this.hasCustomColor="1"===r.attribute("vietvan_ca_hero_custom_color_enabled"),this.titleStyle={},this.descriptionStyle={},this.hasCustomColor){var u=r.attribute("vietvan_ca_hero_title_color")||"#ffffff",c=r.attribute("vietvan_ca_hero_subtitle_color")||"#ffffff";this.titleStyle={color:u},this.descriptionStyle={color:c}}}},o.computeMode=function(){var t;if(document.body.classList.contains("flarum--night"))return"dark";var e=app.session.user;if(e){var o=e.preferences().fofNightMode;return 2===o||"2"===o?"dark":1===o||"1"===o||0!==o&&"0"!==o&&null!=o||0!==o&&"0"!==o||!window.matchMedia("(prefers-color-scheme: dark)").matches?"light":"dark"}var n=null==(t=document.cookie.split("; ").find((function(t){return t.startsWith("flarum_nightmode=")})))?void 0:t.split("=")[1];return"2"===n?"dark":"1"===n?"light":"0"===n&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},o.setupNightModeListener=function(){var t=this;this.nightModeHandler=function(e){t.mode="day"===e.detail?"light":"dark",m.redraw()},document.addEventListener("fofnightmodechange",this.nightModeHandler)},o.setupSystemModeListener=function(){var t=this,e=window.matchMedia("(prefers-color-scheme: dark)");this.systemModeHandler=function(e){var o=t.computeMode();o!==t.mode&&(t.mode=o,m.redraw())},e.addEventListener("change",this.systemModeHandler)},o.setupBodyClassObserver=function(){var t=this;this.bodyObserver=new MutationObserver((function(){var e=t.computeMode();e!==t.mode&&(t.mode=e,m.redraw())})),this.bodyObserver.observe(document.body,{attributes:!0,attributeFilter:["class"]})},o.onremove=function(){this.nightModeHandler&&document.removeEventListener("fofnightmodechange",this.nightModeHandler),this.systemModeHandler&&window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",this.systemModeHandler),this.bodyObserver&&this.bodyObserver.disconnect()},o.getBackgroundStyle=function(){var t=app.forum,e="dark"===this.mode?"vietvan_ca_hero_background_image_darkUrl":"vietvan_ca_hero_background_imageUrl",o=t.attribute(e);return o?{height:"35vh",backgroundImage:"url("+o+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}:void 0},o.view=function(){if(!this.enabled)return null;var t=window.location.pathname;if("/"!==t&&""!==t)return null;var e=this.getBackgroundStyle();return m("div",{className:"HeroSection",style:e},this.showText&&m("div",{className:"container"},m("h1",{className:"HeroSection-title",style:this.titleStyle},this.title),m("p",{className:"HeroSection-subtitle",style:this.descriptionStyle},this.description)),m("div",{className:"container"},m(B(),{state:app.search})))},e}(w()),K=function(t){function o(){return t.apply(this,arguments)||this}y(o,t);var n=o.prototype;return n.oninit=function(o){var n;t.prototype.oninit.call(this,o),this.mode=2===(null==(n=e().session.user)?void 0:n.preferences().fofNightMode)?"dark":"light",flarum.extensions["fof-nightmode"]&&this.setupNightModeListener()},n.setupNightModeListener=function(){var t=this;document.addEventListener("fofnightmodechange",(function(e){t.mode="day"===e.detail?"light":"dark",m.redraw()}))},n.view=function(t){var o="dark"===this.mode?"vietvan_ca_logo_darkUrl":"vietvan_ca_logoUrl",n=e().forum.attribute(o);if(!n)return null;var i=e().forum.attribute("vietvan_ca_back_button_custom_url")||e().route("index"),r=t.attrs.imageStyle||{};return m("a",{href:i,className:"Header-logo CustomHeaderLogo"},m("img",{src:n,alt:"VietVan CA",style:r}))},o}(w()),J=function(t){function o(){return t.apply(this,arguments)||this}y(o,t);var n=o.prototype;return n.view=function(){var t,o=this,n=null==(t=e().search.params())?void 0:t.sort,i=[{key:"latest",label:e().translator.trans("core.forum.index_sort.latest_button"),sortParam:"",default:!0},{key:"top",label:e().translator.trans("core.forum.index_sort.top_button"),sortParam:"top"},{key:"newest",label:e().translator.trans("core.forum.index_sort.newest_button"),sortParam:"newest"},{key:"oldest",label:e().translator.trans("core.forum.index_sort.oldest_button"),sortParam:"oldest"}];return m("div",{className:"CustomDiscussionTabNavigation"},i.map((function(t){var i;return i=t.routeName?e().current.matches(t.routeName):t.isFilter?e().search.params.q&&e().search.params.q.includes(t.filterParam):n===t.sortParam||!n&&t.default,m(F(),{className:"SortItem Button Button--link "+(i?"active":""),onclick:function(){return o.navigateTo(t)}},t.label)})))},n.navigateTo=function(t){var e=m.route.get().split("?")[0];t.default||(e+="?sort="+t.sortParam),m.route.set(e)},o}(w());function X(t,o){var n=e().translator.trans("vietvan-ca-flarum-themes.forum.mobile_drawer."+t);return n&&n!=="vietvan-ca-flarum-themes.forum.mobile_drawer."+t?n:o}flarum.core.compat["common/components/Separator"];var Y=function(t){function o(){return t.apply(this,arguments)||this}y(o,t);var n=o.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e)},n.view=function(){return m("div",{className:"CustomMobileDrawer"},m("div",{className:"CustomMobileDrawer-logo"},m(K,{imageStyle:{height:"40px"}})),m("nav",{className:"CustomMobileDrawer-nav"},m("ul",{className:"CustomMobileDrawer-menu"},R()(this.menuItems().toArray()))),m("div",{className:"CustomMobileDrawer-separator"}),m("div",{className:"CustomMobileDrawer-auth"},e().session.user?this.loggedInSection():this.guestSection()))},n.menuItems=function(){var t=new(V()),o=e().forum.attribute("vietvan_ca_back_button_custom_url")||e().forum.attribute("baseUrl").replace("/forum","");t.add("home",m("li",{className:"CustomMobileDrawer-menuItem"},m("a",{href:o,className:"CustomMobileDrawer-link"},X("home","Trang Chủ"))),100),t.add("forum",m("li",{className:"CustomMobileDrawer-menuItem active"},m("a",{href:e().forum.attribute("baseUrl"),className:"CustomMobileDrawer-link"},X("forum","Diễn Đàn"))),90);var n=this.findTagBySlug("luu-y")||this.findTagBySlug("guidelines");return n&&t.add("guidelines",m("li",{className:"CustomMobileDrawer-menuItem"},m("a",{href:e().route("tag",{tags:n.slug()}),className:"CustomMobileDrawer-link"},X("guidelines","Lưu ý"))),80),t.add("language",m("li",{className:"CustomMobileDrawer-menuItem CustomMobileDrawer-menuItem--dropdown"},this.languageDropdown()),70),t.add("theme",m("li",{className:"CustomMobileDrawer-menuItem CustomMobileDrawer-menuItem--dropdown"},this.themeToggle()),60),t},n.findTagBySlug=function(t){return e().store&&e().store.all?e().store.all("tags").find((function(e){return e.slug()===t})):null},n.languageDropdown=function(){var t=this,o=e().data.locales||{},n=e().data.locale||"en";return Object.keys(o).length<=1?m("div",{className:"CustomMobileDrawer-languageDisplay"},m("span",{className:"CustomMobileDrawer-link"},this.getLocaleName(n),m("i",{className:"fas fa-globe CustomMobileDrawer-icon"}))):m("div",{className:"CustomMobileDrawer-dropdown"},m("button",{className:"CustomMobileDrawer-link CustomMobileDrawer-dropdownTrigger",onclick:function(e){return t.toggleDropdown(e,"language")}},this.getLocaleName(n),m("i",{className:"fas fa-chevron-down CustomMobileDrawer-chevron"})),m("ul",{className:"CustomMobileDrawer-dropdownMenu",id:"language-dropdown"},Object.keys(o).map((function(e){return m("li",{key:e},m("a",{href:"javascript:void(0)",onclick:function(){return t.changeLocale(e)},className:n===e?"active":""},o[e]))}))))},n.getLocaleName=function(t){var o;return{en:"English",vi:"Tiếng Việt"}[t]||(null==(o=e().data.locales)?void 0:o[t])||t},n.changeLocale=function(t){e().session.user?e().session.user.savePreferences({locale:t}).then((function(){window.location.reload()})):(document.cookie="locale="+t+";path=/;max-age=31536000",window.location.reload())},n.themeToggle=function(){var t=this;return e().forum.attribute("darkMode")||localStorage.getItem("fofNightMode"),m("button",{className:"CustomMobileDrawer-link",onclick:function(){return t.toggleTheme()}},m("i",{className:"fas fa-cog CustomMobileDrawer-icon--left"}),X("appearance","Giao Diện"))},n.toggleTheme=function(){var t=document.querySelector(".item-nightMode button, .NightMode-toggle");if(t)t.click();else{document.body.classList.toggle("dark");var e=document.body.classList.contains("dark");localStorage.setItem("fofNightMode",e?"dark":"light")}},n.toggleDropdown=function(t,e){t.preventDefault(),t.stopPropagation();var o=document.getElementById(e+"-dropdown");o&&o.classList.toggle("open")},n.guestSection=function(){var t=this,o=e().forum.attribute("vietvan_ca_back_button_custom_url")||"",n=o?o.replace("/forum","").replace(/\/$/,""):"",i=e().forum.attribute("jwt-sso.login_url")||n+"/auth/login";return m("div",{className:"CustomMobileDrawer-guest"},m("a",{href:n+"/auth/register",className:"Button Button--primary CustomMobileDrawer-registerBtn"},X("register","Đăng ký")),m("a",{href:i,className:"Button Button--secondary CustomMobileDrawer-loginBtn"},X("login","Đăng nhập")),m("div",{className:"CustomMobileDrawer-socialSeparator"},m("span",null,X("or","Hoặc:"))),m("div",{className:"CustomMobileDrawer-socialButtons"},m("button",{className:"Button CustomMobileDrawer-socialBtn CustomMobileDrawer-socialBtn--facebook",onclick:function(){return t.socialLogin("facebook")}},m("i",{className:"fab fa-facebook CustomMobileDrawer-socialIcon"}),X("login_facebook","Đăng nhập bằng Facebook")),m("button",{className:"Button CustomMobileDrawer-socialBtn CustomMobileDrawer-socialBtn--google",onclick:function(){return t.socialLogin("google")}},m("img",{src:"https://www.google.com/favicon.ico",alt:"Google",className:"CustomMobileDrawer-socialIcon CustomMobileDrawer-socialIcon--img"}),X("login_google","Đăng nhập bằng Google"))))},n.socialLogin=function(t){var o=e().forum.attribute("vietvan_ca_back_button_custom_url")||"",n=o?o.replace("/forum","").replace(/\/$/,""):"",i=encodeURIComponent(window.location.href);window.location.href=n+"/auth/"+t+"?redirect="+i},n.loggedInSection=function(){var t=this,o=e().session.user;return m("div",{className:"CustomMobileDrawer-user"},m("div",{className:"CustomMobileDrawer-userInfo"},m("div",{className:"CustomMobileDrawer-avatar"},m("img",{src:o.avatarUrl(),alt:o.displayName()})),m("div",{className:"CustomMobileDrawer-userName"},m("span",{className:"CustomMobileDrawer-displayName"},o.displayName()))),m("ul",{className:"CustomMobileDrawer-userMenu"},m("li",null,m("a",{href:e().route.user(o),className:"CustomMobileDrawer-link"},m("i",{className:"fas fa-user CustomMobileDrawer-icon--left"}),X("profile","Trang cá nhân"))),m("li",null,m("a",{href:e().route("settings"),className:"CustomMobileDrawer-link"},m("i",{className:"fas fa-cog CustomMobileDrawer-icon--left"}),X("settings","Cài đặt tài khoản"))),m("li",null,m("button",{className:"CustomMobileDrawer-link CustomMobileDrawer-logout",onclick:function(){return t.logout()}},m("i",{className:"fas fa-sign-out-alt CustomMobileDrawer-icon--left"}),X("logout","Đăng xuất")))))},n.logout=function(){var t=X("logout_confirm","Bạn có chắc chắn muốn đăng xuất?");confirm(t)&&e().session.logout()},o}(w()),Z=function(){function t(){this.observers=new Map,this.cleanupQueue=new Set,this.loadingQueue=new Set,this.isProcessing=!1,this.isLoadingManagementActive=!1,this.loadingTimeout=null,this.pageTransitionStart=null,this.isInitialLoad=!0,this.initialLoadComplete=!1}var e=t.prototype;return e.cleanup=function(){if(!this.isProcessing){this.isProcessing=!0;try{this.hideByAttributes(),this.hideByPosition(),this.hideUploadButtons(),this.hideRichTextToggle()}catch(t){console.warn("PageManager: Error during cleanup:",t)}finally{this.isProcessing=!1}}},e.manageLoadingState=function(){if(!this.isLoadingManagementActive){this.isLoadingManagementActive=!0;try{this.clearOnlyStuckLoading(),this.ensureCompletedContentVisibility()}catch(t){console.warn("PageManager: Error during loading management:",t)}finally{this.isLoadingManagementActive=!1}}},e.clearOnlyStuckLoading=function(){var t=this;[".LoadingIndicator",".Loading",".loading",".App-loading","#flarum-loading"].forEach((function(e){document.querySelectorAll(e).forEach((function(e){"flarum-loading"===e.id?t.handleFlarumInitialLoading(e):t.isLoadingStuck(e)&&(console.warn("PageManager: Found stuck loading indicator, hiding:",e),t.forceHideLoading(e))}))}))},e.handleFlarumInitialLoading=function(t){if(t)if(window.app&&window.app.forum&&document.querySelector(".App"))console.log("PageManager: App loaded, removing default Flarum loading screen"),t.style.setProperty("opacity","0","important"),t.style.setProperty("transition","opacity 0.3s ease-out","important"),setTimeout((function(){t.style.setProperty("display","none","important"),t.remove()}),300);else{var e=t.dataset.vietvanVisibleSince;if(!e)return void(t.dataset.vietvanVisibleSince=Date.now());Date.now()-parseInt(e)>1e4&&(console.warn("PageManager: Initial Flarum loading taking too long, forcing hide"),this.forceHideLoading(t))}},e.isLoadingStuck=function(t){if(!t)return!1;if(this.isInitialLoad&&!this.initialLoadComplete)return!1;if(t.classList.contains("fa-spin")||t.classList.contains("animate-spin")||t.classList.contains("fa-spinner")||t.classList.contains("spinner")||"none"!==window.getComputedStyle(t).animationName){var e=t.dataset.vietvanVisibleSince;return e?Date.now()-parseInt(e)>2e4:(t.dataset.vietvanVisibleSince=Date.now(),!1)}var o=t.dataset.vietvanVisibleSince;return o?Date.now()-parseInt(o)>12e3:(t.dataset.vietvanVisibleSince=Date.now(),!1)},e.ensureCompletedContentVisibility=function(){var t=this;document.querySelector('.LoadingIndicator:not([data-vietvan-force-hidden="true"]), .Loading:not([data-vietvan-force-hidden="true"])')||"complete"!==document.readyState||[".App-content",".DiscussionPage-content",".IndexPage-content"].forEach((function(e){var o=document.querySelector(e);o&&t.isContentHidden(o)&&(console.log("PageManager: Ensuring content visibility for:",e),t.ensureElementVisible(o))}))},e.forceHideLoading=function(t){t&&(console.warn("PageManager: Force hiding stuck loading element:",t),t.style.setProperty("display","none","important"),t.style.setProperty("visibility","hidden","important"),t.style.setProperty("opacity","0","important"),t.classList.add("vietvan-force-hidden"),t.setAttribute("aria-hidden","true"),t.dataset.vietvanForceHidden="true")},e.ensureContentVisibility=function(){var t=this;[".App-content",".DiscussionPage-content",".IndexPage-content",".UserPage-content",".PostsUserPage-content"].forEach((function(e){var o=document.querySelector(e);o&&t.isContentHidden(o)&&t.ensureElementVisible(o)}))},e.isContentHidden=function(t){if(!t)return!1;var e=window.getComputedStyle(t),o="none"===e.display||"hidden"===e.visibility||"0"===e.opacity,n=document.querySelector('.LoadingIndicator:not([data-vietvan-force-hidden="true"]), .Loading:not([data-vietvan-force-hidden="true"])'),i="complete"===document.readyState&&!n;return o&&i},e.ensureElementVisible=function(t){t&&(t.style.removeProperty("display"),t.style.removeProperty("visibility"),t.style.removeProperty("opacity"),t.classList.remove("vietvan-force-hidden"),t.removeAttribute("aria-hidden"))},e.handleLoadingTimeout=function(){var t=this;this.loadingTimeout&&clearTimeout(this.loadingTimeout),document.querySelectorAll('.LoadingIndicator:not([data-vietvan-force-hidden="true"]), .Loading:not([data-vietvan-force-hidden="true"])').length>0&&(this.loadingTimeout=setTimeout((function(){console.warn("PageManager: Loading timeout reached, checking for stuck indicators"),t.clearOnlyStuckLoading()}),2e4))},e.forceCompleteLoading=function(){var t=this;document.querySelectorAll(".LoadingIndicator, .Loading, .loading").forEach((function(e){t.isLoadingStuck(e)&&t.forceHideLoading(e)})),document.querySelector('.LoadingIndicator:not([data-vietvan-force-hidden="true"]), .Loading:not([data-vietvan-force-hidden="true"])')||this.ensureCompletedContentVisibility(),window.dispatchEvent(new CustomEvent("vietvan:loading-forced-complete"))},e.hideByAttributes=function(){var t=this,e=document.querySelector(".TextEditor-toolbar");e&&['button[data-hotkey="Ctrl+K"]','button[title*="Link"]','div[data-tooltip*="Link"]','button[data-hotkey="Ctrl+>"]','button[title*="Quote"]','div[data-tooltip*="Quote"]','button[data-hotkey="Ctrl+`"]','button[title*="Code"]','div[data-tooltip*="Code"]'].forEach((function(o){e.querySelectorAll(o).forEach((function(e){return t.hideElement(e)}))}))},e.hideByPosition=function(){var t=this;[".TextEditor-toolbar > div > button:nth-child(4)",".TextEditor-toolbar > div > button:nth-child(5)",".TextEditor-toolbar > div > div:nth-child(1)",".TextEditor-toolbar > div > div:nth-child(6)",".TextEditor-toolbar > div > div:nth-child(7)",".TextEditor-toolbar > div > div:nth-child(10)"].forEach((function(e){document.querySelectorAll(e).forEach((function(e){return t.hideElement(e)}))}))},e.hideUploadButtons=function(){var t=this;[".item-fof-upload","li.item-fof-upload",'.Button--icon[title*="upload" i]','.Button--icon[title*="file" i]'].forEach((function(e){document.querySelectorAll(e).forEach((function(e){return t.hideElement(e)}))}))},e.hideRichTextToggle=function(){var t=this;document.querySelectorAll(".item-rich-text").forEach((function(e){return t.hideElement(e)}))},e.hideElement=function(t){t&&!t.dataset.vietvanHidden&&(t.dataset.vietvanHidden="true",t.style.setProperty("display","none","important"),t.style.setProperty("visibility","hidden","important"),t.style.setProperty("opacity","0","important"),t.style.setProperty("pointer-events","none","important"),t.style.setProperty("height","0","important"),t.style.setProperty("width","0","important"),t.style.setProperty("overflow","hidden","important"),t.style.setProperty("margin","0","important"),t.style.setProperty("padding","0","important"),t.classList.add("vietvan-hidden"),t.setAttribute("aria-hidden","true"),t.setAttribute("hidden",""))},e.startObserving=function(){var t=this,e=function(){var e=document.querySelector("#composer");if(e&&!t.observers.has("composer")){var o=new MutationObserver((function(e){var o=!1;e.forEach((function(t){"childList"===t.type?t.addedNodes.forEach((function(t){t.nodeType===Node.ELEMENT_NODE&&(null!=t.matches&&t.matches(".TextEditor-toolbar")||null!=t.querySelector&&t.querySelector(".TextEditor-toolbar"))&&(o=!0)})):"attributes"===t.type&&null!=t.target.matches&&t.target.matches(".TextEditor-toolbar *")&&(o=!0)})),o&&t.scheduleCleanup()}));o.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class","data-hotkey","title"]}),t.observers.set("composer",o)}};e(),function(){if(!t.observers.has("body")){var o=new MutationObserver((function(o){var n=!1;o.forEach((function(o){"childList"===o.type&&(o.addedNodes.forEach((function(o){if(o.nodeType===Node.ELEMENT_NODE&&((null!=o.matches&&o.matches("#composer")||null!=o.querySelector&&o.querySelector("#composer"))&&(setTimeout(e,50),n=!0),null!=o.matches&&o.matches(".LoadingIndicator, .Loading, .loading")||null!=o.querySelector&&o.querySelector(".LoadingIndicator, .Loading, .loading"))){if(t.isInitialLoad&&!t.initialLoadComplete)return;setTimeout((function(){t.scheduleLoadingManagement()}),5e3)}})),o.removedNodes.forEach((function(e){e.nodeType===Node.ELEMENT_NODE&&null!=e.matches&&e.matches(".LoadingIndicator, .Loading, .loading")&&setTimeout((function(){t.ensureCompletedContentVisibility()}),100)})))})),n&&t.scheduleCleanup()}));o.observe(document.body,{childList:!0,subtree:!0,attributes:!1}),t.observers.set("body",o)}}()},e.scheduleCleanup=function(){var t=this;this.cleanupQueue.add(Date.now()),setTimeout((function(){t.cleanupQueue.size>0&&(t.cleanupQueue.clear(),t.cleanup())}),50)},e.scheduleLoadingManagement=function(){var t=this;this.loadingQueue.add(Date.now()),setTimeout((function(){t.loadingQueue.size>0&&(t.loadingQueue.clear(),t.clearOnlyStuckLoading())}),2e3)},e.stopObserving=function(){this.observers.forEach((function(t){return t.disconnect()})),this.observers.clear()},e.initialize=function(){var t,e=this;this.handleInitialFlarumLoading(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){setTimeout((function(){e.handleInitialFlarumLoading(),e.cleanup(),e.markInitialLoadComplete()}),500)})):setTimeout((function(){e.handleInitialFlarumLoading(),e.cleanup(),e.markInitialLoadComplete()}),200),setTimeout((function(){e.startObserving()}),1e3),null!=(t=window.app)&&null!=(t=t.history)&&t.router&&window.app.history.router.on("changed",(function(){e.pageTransitionStart=Date.now(),e.isInitialLoad=!1,setTimeout((function(){e.cleanup(),setTimeout((function(){return e.clearOnlyStuckLoading()}),5e3)}),200)})),document.addEventListener("visibilitychange",(function(){document.hidden||setTimeout((function(){e.cleanup(),e.isInitialLoad||setTimeout((function(){return e.clearOnlyStuckLoading()}),2e3)}),100)})),"complete"===document.readyState?setTimeout((function(){e.handleInitialFlarumLoading(),e.markInitialLoadComplete(),e.ensureCompletedContentVisibility()}),500):window.addEventListener("load",(function(){setTimeout((function(){e.handleInitialFlarumLoading(),e.markInitialLoadComplete(),e.ensureCompletedContentVisibility()}),500)})),setInterval((function(){document.querySelector(".TextEditor-toolbar")&&e.cleanup(),e.handleInitialFlarumLoading()}),3e4),setInterval((function(){e.isInitialLoad||e.clearOnlyStuckLoading()}),18e4)},e.handleInitialFlarumLoading=function(){var t=document.querySelector("#flarum-loading");t&&this.handleFlarumInitialLoading(t)},e.markInitialLoadComplete=function(){var t=this;this.initialLoadComplete=!0,setTimeout((function(){t.isInitialLoad=!1}),3e3)},t}();function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=Array(e);o<e;o++)n[o]=t[o];return n}e().initializers.add("vietvan-ca-themes",(function(){var t=new Z;t.initialize();var i,a=function(){document.querySelectorAll(".item-hide button .fa-trash-alt").forEach((function(t){t.classList.contains("fa-trash-alt")&&(t.classList.remove("fa-trash-alt"),t.classList.add("fa-eye"))})),document.querySelectorAll(".item-hidden .fas.fa-trash, .Badge--hidden .fas.fa-trash").forEach((function(t){t.classList.contains("fa-trash")&&(t.classList.remove("fa-trash"),t.classList.add("fa-eye"))}))};setTimeout(a,500),null!=(i=e().history)&&i.initialized&&e().history.initialized.then((function(){e().history.router.on("changed",(function(){setTimeout(a,500)}))})),setInterval(a,2e3),setTimeout((function(){e().session.user&&(null==e().session.user.preferences().fofNightMode&&e().session.user.savePreferences({fofNightMode:!1}).catch((function(){})));var t=document.body,o=document.documentElement;"true"===localStorage.getItem("fof-nightmode")||"true"===localStorage.getItem("darkMode")||[t,o].forEach((function(t){t&&["dark","dark-mode","fof-nightmode"].forEach((function(e){t.classList.remove(e)}))}))}),100);var u,l=function(){document.querySelectorAll(".discussion-tag.colored").forEach((function(t){return f(t,"backgroundColor")})),document.querySelectorAll('.Button--tagColored, .Button--primary[style*="--color"]').forEach((function(t){var e=t.style.getPropertyValue("--color");e&&f(t,"customColor",e)}))},f=function(t,e,o){var n,i,r,a;if(void 0===o&&(o=null),(n="customColor"===e&&o?o:window.getComputedStyle(t).backgroundColor).startsWith("#")){var s=n.replace("#","");if(3===s.length)i=parseInt(s.substr(0,1)+s.substr(0,1),16),r=parseInt(s.substr(1,1)+s.substr(1,1),16),a=parseInt(s.substr(2,1)+s.substr(2,1),16);else{if(6!==s.length)return;i=parseInt(s.substr(0,2),16),r=parseInt(s.substr(2,2),16),a=parseInt(s.substr(4,2),16)}}else{var u=n.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(!u)return;var c=u.map(Number);i=c[1],r=c[2],a=c[3]}var l=(.299*i+.587*r+.114*a)/255,m=Math.sqrt(.241*i*i+.691*r*r+.068*a*a)/255,d=(i+r+a)/765,f=Math.max(i,r,a)/255,h=Math.min(i,r,a)/255,p=0===f?0:(f-h)/f,v=(Math.max(l,.05)+.05)/.1,g=1.05/(Math.max(l,.05)+.05),y=p>.8&&l>.7?.6:p>.4?.75:.65,b=l>y&&m>y-.1&&d>y-.15&&v>g;t.style.setProperty("color",b?"#000000":"#ffffff","important");var w=b?"0 0 1px rgba(255, 255, 255, 0.6)":"0 0 1px rgba(0, 0, 0, 0.8)";t.style.setProperty("text-shadow",w,"important"),"customColor"===e&&o&&(t.style.setProperty("background-color",o,"important"),t.classList.remove("text-contrast--dark","text-contrast--light"))};setTimeout(l,200),null!=(u=e().history)&&u.initialized&&e().history.initialized.then((function(){e().history.router.on("changed",(function(){setTimeout(l,200)}))})),setInterval(l,3e3),new MutationObserver((function(){setTimeout(l,100)})).observe(document.body,{childList:!0,subtree:!0}),(0,n.extend)(v().prototype,"oncreate",(function(){setTimeout((function(){t.cleanup()}),50)})),(0,n.extend)(v().prototype,"onupdate",(function(){setTimeout((function(){return t.cleanup()}),25)})),(0,n.extend)(r().prototype,"oncreate",(function(){this.injectCustomDrawer()})),(0,n.extend)(r().prototype,"onupdate",(function(){this.injectCustomDrawer()}));var p=function(e){(0,n.extend)(e.prototype,"oncreate",(function(){setTimeout((function(){return t.clearOnlyStuckLoading()}),5e3)}))};try{p(o(24).default)}catch(t){console.log("DiscussionPage not available for loading management")}try{p(o(947).default)}catch(t){console.log("UserPage not available for loading management")}r().prototype.injectCustomDrawer=function(){var t=document.getElementById("drawer");if(t&&!t.querySelector(".CustomMobileDrawer")){var e=t.querySelector(".Drawer-content, .App-drawer");if(e){var o=e.querySelector(".CustomMobileDrawer-container");o||((o=document.createElement("div")).className="CustomMobileDrawer-container",m.mount(o,Y),e.insertBefore(o,e.firstChild))}}};var g,y=function(){!function(){try{var t;if(null!=(t=e().forum)&&t.attribute&&"1"!==e().forum.attribute("vietvan_ca_show_register_button")){var o=document.querySelector(".item-signUp");null==o||o.remove()}}catch(t){console.error("Error checking register button visibility:",t)}}(),function(){try{var t=e().forum.attribute("vietvan_ca_logoUrl"),o=e().forum.attribute("vietvan_ca_logo_darkUrl");if(t||o){var n=document.querySelector(".Header-title");null==n||n.remove()}}catch(t){console.error("Error checking custom logo:",t)}}()};"complete"===document.readyState||"interactive"===document.readyState?setTimeout(y,100):document.addEventListener("DOMContentLoaded",(function(){setTimeout(y,100)})),null==(g=e().history.initialized)||g.then((function(){e().history.router.on("changed",y)})),(0,n.extend)(d().prototype,"items",(function(t){var o=e().forum.attribute("vietvan_ca_logoUrl"),n=e().forum.attribute("vietvan_ca_logo_darkUrl");(o||n)&&t.add("logo",m(K,null),90)})),(0,n.extend)(h().prototype,"items",(function(t){t.has("search")&&t.remove("search")})),(0,n.extend)(s().prototype,"view",(function(t){t.children=[m(T,{discussion:this.attrs.discussion})]})),(0,n.extend)(c().prototype,"view",(function(t){var e=t.children;t.children=[m("ul.DiscussionList",[m(P)].concat(e))]})),(0,n.extend)(r().prototype,"view",(function(t){var e=m(W),o=t.children;t.children=[e].concat(o);var n=m($,null),i=m(J,null),r=function(t){for(var e,o,n=t,i=function(){var t,e=o.value;if(null==(t=n)||!t.children||!Array.isArray(n.children))return{v:null};var i=n.children.find((function(t){var o;return null==t||null==(o=t.attrs)||null==(o=o.className)?void 0:o.includes(e)}));if(!i)return{v:null};n=i},r=function(t,e){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(o)return(o=o.call(t)).next.bind(o);if(Array.isArray(t)||(o=function(t,e){if(t){if("string"==typeof t)return tt(t,e);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?tt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){o&&(t=o);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(["container","sideNavContainer","IndexPage-results","IndexPage-toolbar","IndexPage-toolbar-view"]);!(o=r()).done;)if(e=i())return e.v;return n}({children:o});r?r.children=[n,i]:console.warn("IndexPage-toolbar-view not found. CustomTabNavigation not added."),setTimeout(y,100)})),(0,n.extend)(r().prototype,"oncreate",(function(){var t=e().forum.attribute("vietvan_ca_logoUrl"),o=e().forum.attribute("vietvan_ca_logo_darkUrl");(t||o)&&this.addMobileLogo()})),(0,n.extend)(r().prototype,"onupdate",(function(){var t=e().forum.attribute("vietvan_ca_logoUrl"),o=e().forum.attribute("vietvan_ca_logo_darkUrl");(t||o)&&this.addMobileLogo()})),r().prototype.addMobileLogo=function(){var t=document.getElementById("app-navigation");if(t&&!t.querySelector(".Navigation-logo")){var e=document.createElement("div");e.className="Navigation-logo Mobile-only",m.mount(e,{view:function(){return m(K,{imageStyle:{height:"30px"}})}});var o=t.querySelector(".App-backControl");o?t.insertBefore(e,o):t.insertBefore(e,t.firstChild)}},(0,n.extend)(r().prototype,"onremove",(function(){var t=document.getElementById("app-navigation"),e=null==t?void 0:t.querySelector(".Navigation-logo");e&&(m.mount(e,null),e.remove())})),function(t){var e=document.getElementById("font-zoom-style");e&&e.remove();var o=document.createElement("style");o.id="font-zoom-style",o.textContent="\n    .App {\n      font-size: 1.05rem !important;\n    }\n    \n    /* Ensure consistent scaling across all text elements */\n    .Post-body,\n    .PostPreview-body,\n    .UserCard-info,\n    .NotificationGrid-content,\n    .Dropdown-menu,\n    .Modal-body,\n    .Form-group label,\n    .Form-group input,\n    .Form-group textarea,\n    .TagLabel,\n    .Badge {\n      font-size: 1.05em !important;\n    }\n    \n    /* Scale headings proportionally */\n    h1 { font-size: 2.1rem !important; }\n    h2 { font-size: "+1.5*t+"rem !important; }\n    h3 { font-size: 1.3125rem !important; }\n    h4 { font-size: "+1.125*t+"rem !important; }\n    h5 { font-size: 1.05rem !important; }\n    h6 { font-size: "+.875*t+"rem !important; }\n    \n    /* Scale code blocks */\n    code,\n    pre {\n      font-size: "+.875*t+"em !important;\n    }\n  ",document.head.appendChild(o),localStorage.setItem("flarum-font-zoom-scale",t.toString())}(1.05)}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map